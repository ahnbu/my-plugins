# bkit (Vibecoding Kit) 문서화 시스템 분석 보고서

> 날짜: 2026-02-25
> 소스: https://github.com/popup-studio-ai/bkit-claude-code
> 버전: v1.5.5

## 1. 개요

bkit은 POPUP STUDIO가 개발한 Claude Code 플러그인으로, **PDCA 방법론 + CTO-Led Agent Teams + Context Engineering**을 결합한 AI-네이티브 개발 플랫폼이다.

핵심 철학: "Context Engineering — LLM 추론을 위한 최적의 컨텍스트 토큰 큐레이션"

### 규모

| 항목 | 수치 |
|------|------|
| Skills | 27개 |
| Agents | 16개 |
| Scripts | 45개 (Node.js) |
| Library Functions | 241개 (5개 모듈) |
| Hook Events | 10개 |
| 지원 언어 | 8개 (EN, KO, JA, ZH, ES, FR, DE, IT) |
| 프로젝트 레벨 | 3단계 (Starter, Dynamic, Enterprise) |

---

## 2. PDCA 사이클 기반 문서 생성

### 2.1 명령어 체계

```
/pdca plan [feature]      # Plan 문서 생성
/pdca design [feature]    # Design 문서 생성 (Plan 필수)
/pdca do [feature]        # 구현 가이드 제공 (Design 필수)
/pdca analyze [feature]   # 갭 분석 — gap-detector 에이전트 호출
/pdca iterate [feature]   # 자동 수정 — pdca-iterator 에이전트 호출
/pdca report [feature]    # 완료 보고서 — report-generator 에이전트 호출
/pdca archive [feature]   # 완료 문서 아카이브
/pdca team [feature]      # CTO-Led 팀 모드 (Agent Teams 필요)
/pdca status              # 현재 상태 조회
/pdca next                # 다음 단계 안내
```

### 2.2 문서 폴더 구조

```
docs/
├── 01-plan/
│   └── features/
│       └── {feature}.plan.md          # 기능 계획서
├── 02-design/
│   └── features/
│       └── {feature}.design.md        # 기술 설계서
├── 03-analysis/
│   └── {feature}.analysis.md          # 갭 분석 결과
├── 04-report/
│   └── {feature}.report.md            # 완료 보고서
├── archive/
│   └── YYYY-MM/                       # 월별 아카이브
│       └── {feature-version}/
├── .pdca-status.json                  # 기능별 진행 상태 (기계용)
└── .bkit-memory.json                  # 세션 메타정보
```

### 2.3 단계별 선행조건 체인

```
plan → design → do → analyze → iterate → report
       (Plan     (Design    (구현 코드  (matchRate   (Check ≥ 90%
        필수)     필수)      존재 필수)  < 90%)       권장)
```

---

## 3. 템플릿 시스템

### 3.1 템플릿 목록

| 템플릿 | 용도 | 레벨별 분화 |
|--------|------|-------------|
| `plan.template.md` | 기능 계획서 | `plan-starter.template.md` |
| `plan-plus.template.md` | 브레인스토밍 강화 계획서 | - |
| `design.template.md` | 기술 설계서 | `design-starter.template.md`, `design-enterprise.template.md` |
| `do.template.md` | 구현 가이드 | - |
| `analysis.template.md` | 갭 분석 결과 | - |
| `report.template.md` | 완료 보고서 | - |
| `iteration-report.template.md` | 반복 개선 보고서 | - |
| `schema.template.md` | 스키마 설계 | - |
| `convention.template.md` | 코딩 컨벤션 | - |
| `CLAUDE.template.md` | CLAUDE.md 초기화 | - |

### 3.2 템플릿 변수

```yaml
variables:
  - feature: Feature name
  - date: Creation date (YYYY-MM-DD)
  - author: Author
  - project: Project name (from package.json or CLAUDE.md)
  - version: Project version (from package.json)
```

### 3.3 Plan 템플릿 주요 섹션

1. Overview (Purpose, Background, Related Documents)
2. Scope (In Scope / Out of Scope)
3. Requirements (Functional / Non-Functional — 테이블 형식)
4. Success Criteria (Definition of Done)

### 3.4 Report 템플릿 주요 섹션

1. Summary (Project Overview, Results Summary)
2. Related Documents (Plan→Design→Check→Act 링크)
3. Completed Items (FR/NFR 달성 현황 테이블)
4. **Lessons Learned** — 교훈 축적의 핵심 섹션

---

## 4. 상태 관리 시스템

### 4.1 `.pdca-status.json` — 기능 진행 상태

```json
{
  "version": "2.0",
  "lastUpdated": "2026-02-17T12:00:00.000Z",
  "activeFeatures": ["feature1"],
  "primaryFeature": "feature1",
  "features": {
    "feature1": {
      "phase": "do",
      "phaseNumber": 3,
      "matchRate": 85,
      "iterationCount": 2,
      "requirements": [],
      "documents": {},
      "timestamps": {
        "started": "2026-02-22T...",
        "lastUpdated": "2026-02-24T..."
      },
      "lastFile": "..."
    }
  },
  "pipeline": {
    "currentPhase": 3,
    "level": "Dynamic",
    "phaseHistory": [
      { "phase": 1, "completedAt": "2026-02-06T..." },
      { "phase": 2, "completedAt": "2026-02-06T..." }
    ]
  },
  "session": {
    "startedAt": "2026-02-01T...",
    "onboardingCompleted": true,
    "lastActivity": "2026-02-16T..."
  },
  "history": [
    {
      "timestamp": "2026-02-14T...",
      "feature": "cleanup",
      "phase": "archived",
      "action": "Archived 6 features + 4 standalone analysis docs"
    }
  ]
}
```

**역할:**
- 멀티 세션 간 진행 상태 복원
- 기능별 phase, matchRate, iterationCount 추적
- history 배열로 변경 이력 축적
- 아카이브 기록 관리

### 4.2 `.bkit-memory.json` — 세션 메타정보

```json
{
  "sessionCount": 42,
  "lastSession": {
    "startedAt": "2026-02-24T...",
    "platform": "claude",
    "level": "Starter"
  }
}
```

**역할:**
- 누적 세션 수 카운트
- 프로젝트 레벨 자동 감지 결과 저장
- 마지막 세션 메타정보

---

## 5. 에이전트 시스템 (16개)

### 5.1 PDCA 핵심 에이전트

| 에이전트 | 모델 | 역할 | 권한 |
|----------|------|------|------|
| `gap-detector` | opus | Design↔Code 비교, Match Rate 계산 | Read only (Write 금지) |
| `pdca-iterator` | - | 갭 기반 자동 코드 수정 | Write/Edit 허용 |
| `report-generator` | - | PDCA 완료 보고서 생성 | Read/Write (Bash 금지) |
| `cto-lead` | opus | 팀 모드 오케스트레이션 | 전체 |

### 5.2 전문화 에이전트

| 에이전트 | 역할 |
|----------|------|
| `starter-guide` | 초보자 가이드 |
| `pipeline-guide` | 9-단계 파이프라인 안내 |
| `code-analyzer` | 코드 분석 |
| `design-validator` | 설계 검증 (PreToolUse만) |
| `frontend-architect` | 프론트엔드 아키텍처 |
| `bkend-expert` | 백엔드 전문가 |
| `enterprise-expert` | 엔터프라이즈 아키텍처 |
| `infra-architect` | 인프라 설계 |
| `security-architect` | 보안 아키텍처 |
| `product-manager` | 제품 관리 |
| `qa-strategist` | QA 전략 |
| `qa-monitor` | QA 모니터링 |

### 5.3 Check→Act 자동 반복 루프

```
analyze (Check) → matchRate 계산
    │
    ├─ matchRate ≥ 90% → report 단계로
    │
    └─ matchRate < 90% → iterate (Act)
        │
        ├─ 코드 자동 수정
        ├─ 자동 re-analyze
        └─ 최대 5회 반복 후 중단
```

---

## 6. Hook 시스템 (10 이벤트)

### 6.1 이벤트 목록

| 이벤트 | 스크립트 | 역할 |
|--------|---------|------|
| `SessionStart` | `session-start.js` | .bkit-memory 로드, 레벨 감지, 세션 초기화 |
| `UserPromptSubmit` | `user-prompt-handler.js` | 사용자 입력 분석, PDCA 자동 트리거 |
| `PreToolUse (Write\|Edit)` | `pre-write.js` | 쓰기 전 검증 |
| `PreToolUse (Bash)` | `unified-bash-pre.js` | Bash 실행 전 검증 |
| `PostToolUse (Write)` | `unified-write-post.js` | 쓰기 후 상태 갱신 |
| `PostToolUse (Bash)` | `unified-bash-post.js` | Bash 실행 후 상태 갱신 |
| `PostToolUse (Skill)` | `skill-post.js` | 스킬 실행 후 처리 |
| `PreCompact` | `context-compaction.js` | 컨텍스트 압축 전 상태 스냅샷 |
| `Stop` | `unified-stop.js` | 세션 종료 시 상태 최종 저장 |
| `TaskCompleted` | `pdca-task-completed.js` | Task 완료 → PDCA 단계 자동 진행 |
| `SubagentStart` | `subagent-start-handler.js` | 에이전트 시작 시 컨텍스트 주입 |
| `SubagentStop` | `subagent-stop-handler.js` | 에이전트 종료 시 정리 |
| `TeammateIdle` | `team-idle-handler.js` | 팀 모드 idle 처리 |

### 6.2 unified-stop.js — 통합 종료 핸들러

모든 skill/agent의 Stop 이벤트를 하나의 스크립트에서 라우팅:

```javascript
const SKILL_HANDLERS = {
  'pdca': './pdca-skill-stop.js',
  'code-review': './code-review-stop.js',
  'claude-code-learning': './learning-stop.js',
  // ... 10개 스킬 핸들러
};

const AGENT_HANDLERS = {
  'gap-detector': './gap-detector-stop.js',
  'pdca-iterator': './iterator-stop.js',
  'cto-lead': './cto-stop.js',
  // ... 6개 에이전트 핸들러
};
```

> 배경: GitHub #9354 — `${CLAUDE_PLUGIN_ROOT}`가 markdown 파일에서 확장되지 않는 워크어라운드

---

## 7. Context Engineering 아키텍처

### 7.1 Multi-Level Context Hierarchy (FR-01)

```
L1: Plugin Policy (bkit 기본값)
  → L2: User Config (~/.claude/bkit/)
    → L3: Project (.pdca-status)
      → L4: Session (runtime)

우선순위: L4 > L3 > L2 > L1
```

### 7.2 6-Layer Hook System

```
L1: hooks.json (Global)     → SessionStart, UserPromptSubmit, PreCompact 등
L2: Skill Frontmatter       → (deprecated v1.4.4, hooks.json으로 통합)
L3: Agent Frontmatter       → Task-specific hooks
L4: Description Triggers    → 8개 언어 키워드 매칭
L5: Scripts (45 modules)    → 실제 Node.js 실행
L6: Team Orchestration      → CTO-led 팀 라우팅
```

### 7.3 Library 모듈 구조

| 모듈 | 파일 수 | exports | 역할 |
|------|:-------:|:-------:|------|
| `lib/core/` | 7 | 41 | 플랫폼 감지, 캐시, I/O, 디버그, 설정, 파일 유틸 |
| `lib/pdca/` | 6 | 54 | 레벨 감지, 단계 관리, 상태, 자동화 |
| `lib/intent/` | 4 | 19 | 8개 언어 감지, 트리거 매칭, 모호성 분석 |
| `lib/task/` | 5 | 26 | 작업 분류, 컨텍스트, 생성, 추적 |
| `lib/team/` | 9 | 40 | 코디네이터, 전략, CTO 로직, 상태, 통신 |
| **합계** | **31** | **180** | |

---

## 8. 프로젝트 레벨 자동 감지

### Starter

- 조건: 특수 구조 없음 (기본값)
- 문서 복잡도: 낮음

### Dynamic

- 조건: Backend + BaaS 구조 감지
  - `lib/bkend/`, `supabase/`, `.mcp.json`
- 문서 복잡도: 중간

### Enterprise

- 조건: 2개 이상 엔터프라이즈 신호
  - `infra/terraform/`, `kubernetes/`, `services/` (2+), `turbo.json`, `.github/workflows/`
- 문서 복잡도: 높음

---

## 9. 교훈 축적 및 아카이브

### 9.1 Report의 Lessons Learned

완료 보고서 템플릿에 포함된 고정 섹션:
- 예상치 못한 문제
- 해결 방법
- 향후 개선 사항

### 9.2 아카이브 시스템

```bash
/pdca archive {feature}
# → docs/archive/YYYY-MM/{feature}/ 로 이동
/pdca cleanup
# → 아카이브된 기능을 .pdca-status.json에서 제거
```

### 9.3 history 배열

`.pdca-status.json`의 history에 모든 상태 변경이 타임스탬프와 함께 기록됨.

---

## 10. 핵심 설계 원칙 요약

| 원칙 | 구현 |
|------|------|
| **문서가 선행** | Plan→Design 없이 Do 불가 (선행조건 체인) |
| **기계용/사람용 분리** | `.pdca-status.json`(기계) vs plan/design/report(사람) |
| **자동 반복** | Check→Act 루프 (90% 임계값, 5회 제한) |
| **Hook 기반 상태 관리** | 10개 이벤트로 모든 시점에 개입 |
| **레벨별 차별화** | 프로젝트 복잡도에 맞는 템플릿/에이전트 자동 선택 |
| **통합 종료 핸들러** | unified-stop.js로 모든 skill/agent 종료 처리 일원화 |
